<!DOCTYPE html>
<!DOCTYPE html>
<html>
	<meta charset="utf-8">
	<title></title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
<body>
	<select id="year-select">
		<option value="2000" selected="selected">2000</option>
		<option value="2001">2001</option>
		<option value="2002">2002</option>
		<option value="2003">2003</option>
		<option value="2004">2004</option>
		<option value="2005">2005</option>
		<option value="2006">2006</option>
		<option value="2007">2007</option>
		<option value="2008">2008</option>
		<option value="2009">2009</option>
	</select>

	<select id="month-select">
		<option value="1" selected="selected">1</option>
		<option value="2">2</option>
		<option value="3">3</option>
		<option value="4">4</option>
		<option value="5">5</option>
		<option value="6">6</option>
		<option value="7">7</option>
		<option value="8">8</option>
		<option value="9">9</option>
		<option value="10">10</option>
		<option value="11">11</option>
		<option value="12">12</option>
	</select>

	<select id="day-select">
		<option value="1" selected="selected">1</option>
		<option value="2">2</option>
		<option value="3">3</option>
		<option value="4">4</option>
		<option value="5">5</option>
		<option value="6">6</option>
		<option value="7">7</option>
		<option value="8">8</option>
		<option value="9">9</option>
		<option value="10">10</option>
		<option value="11">11</option>
		<option value="12">12</option>
		<option value="13">13</option>
		<option value="14">14</option>
		<option value="15">15</option>
		<option value="16">16</option>
		<option value="17">17</option>
		<option value="18">18</option>
		<option value="19">19</option>
		<option value="20">20</option>
		<option value="21">21</option>
		<option value="22">22</option>
		<option value="23">23</option>
		<option value="24">24</option>
		<option value="25">25</option>
		<option value="26">26</option>
		<option value="27">27</option>
		<option value="28">28</option>
		<option value="29">29</option>
		<option value="30">30</option>
		<option value="31">31</option>
	</select>

	<select id="hour-select">
		<option value="0" selected="selected">00</option>
		<option value="1">01</option>
		<option value="2">02</option>
		<option value="3">03</option>
		<option value="4">04</option>
		<option value="5">05</option>
		<option value="6">06</option>
		<option value="7">07</option>
		<option value="8">08</option>
		<option value="9">09</option>
		<option value="10">10</option>
		<option value="11">11</option>
		<option value="12">12</option>
		<option value="13">13</option>
		<option value="14">14</option>
		<option value="15">15</option>
		<option value="16">16</option>
		<option value="17">17</option>
		<option value="18">18</option>
		<option value="19">19</option>
		<option value="20">20</option>
		<option value="21">21</option>
		<option value="22">22</option>
		<option value="23">23</option>
	</select>

	<select id="minite-select">
		<option value="0" selected="selected">0</option>
		<option value="1">1</option>
		<option value="2">2</option>
		<option value="3">3</option>
		<option value="4">4</option>
		<option value="5">5</option>
		<option value="6">6</option>
		<option value="7">7</option>
		<option value="8">8</option>
		<option value="9">9</option>
		<option value="10">10</option>
		<option value="11">11</option>
		<option value="12">12</option>
		<option value="13">13</option>
		<option value="14">14</option>
		<option value="15">15</option>
		<option value="16">16</option>
		<option value="17">17</option>
		<option value="18">18</option>
		<option value="19">19</option>
		<option value="20">20</option>
		<option value="21">21</option>
		<option value="22">22</option>
		<option value="23">23</option>
		<option value="24">24</option>
		<option value="25">25</option>
		<option value="26">26</option>
		<option value="27">27</option>
		<option value="28">28</option>
		<option value="29">29</option>
		<option value="30">30</option>
		<option value="31">31</option>
		<option value="32">32</option>
		<option value="33">33</option>
		<option value="34">34</option>
		<option value="35">35</option>
		<option value="36">36</option>
		<option value="37">37</option>
		<option value="38">38</option>
		<option value="39">39</option>
		<option value="40">40</option>
		<option value="41">41</option>
		<option value="42">42</option>
		<option value="43">43</option>
		<option value="44">44</option>
		<option value="45">45</option>
		<option value="46">46</option>
		<option value="47">47</option>
		<option value="48">48</option>
		<option value="49">49</option>
		<option value="50">50</option>
		<option value="51">51</option>
		<option value="52">52</option>
		<option value="53">53</option>
		<option value="54">54</option>
		<option value="55">55</option>
		<option value="56">56</option>
		<option value="57">57</option>
		<option value="58">58</option>
		<option value="59">59</option>
	</select>

	<select id="second-select">
		<option value="0" selected="selected">0</option>
		<option value="1">1</option>
		<option value="2">2</option>
		<option value="3">3</option>
		<option value="4">4</option>
		<option value="5">5</option>
		<option value="6">6</option>
		<option value="7">7</option>
		<option value="8">8</option>
		<option value="9">9</option>
		<option value="10">10</option>
		<option value="11">11</option>
		<option value="12">12</option>
		<option value="13">13</option>
		<option value="14">14</option>
		<option value="15">15</option>
		<option value="16">16</option>
		<option value="17">17</option>
		<option value="18">18</option>
		<option value="19">19</option>
		<option value="20">20</option>
		<option value="21">21</option>
		<option value="22">22</option>
		<option value="23">23</option>
		<option value="24">24</option>
		<option value="25">25</option>
		<option value="26">26</option>
		<option value="27">27</option>
		<option value="28">28</option>
		<option value="29">29</option>
		<option value="30">30</option>
		<option value="31">31</option>
		<option value="32">32</option>
		<option value="33">33</option>
		<option value="34">34</option>
		<option value="35">35</option>
		<option value="36">36</option>
		<option value="37">37</option>
		<option value="38">38</option>
		<option value="39">39</option>
		<option value="40">40</option>
		<option value="41">41</option>
		<option value="42">42</option>
		<option value="43">43</option>
		<option value="44">44</option>
		<option value="45">45</option>
		<option value="46">46</option>
		<option value="47">47</option>
		<option value="48">48</option>
		<option value="49">49</option>
		<option value="50">50</option>
		<option value="51">51</option>
		<option value="52">52</option>
		<option value="53">53</option>
		<option value="54">54</option>
		<option value="55">55</option>
		<option value="56">56</option>
		<option value="57">57</option>
		<option value="58">58</option>
		<option value="59">59</option>
	</select>

	<p id="result-wrapper">现在距离 2001年1月1日星期X HH:MM:SS 还有 X 天 X 小时 X 分 X 秒</p>
	
	<script>
	
	setSelectionEvent();
	setPageTimeDifference();
	
	function setSelectionEvent(){
		var yearSelection = document.getElementById("year-select");
		var dayOptions = document.querySelectorAll("#day-select > option");
		
		var year = yearSelection.value;
		var isLeapYear = judgeYearType(year);
		
		
		var monthSelection = document.getElementById("month-select");
		var month = monthSelection.value;
		changeDayOption(month, isLeapYear);
		
		monthSelection.onchange = setDayOptions;
		
		yearSelection.onchange = function(){
			var year = yearSelection.value;
			isLeapYear = judgeYearType(year);
			setDayOptions();
		}
		
		function setDayOptions(){
			var month = monthSelection.value;
			changeDayOption(month, isLeapYear);
			
		}
	}
	
	function changeDayOption(month, isLeapYear){
		month = month / 1;
		switch (month) {
				case 1:
				case 3:
				case 5:
				case 7:
				case 8:
				case 10:
				case 11: {
					hideDayOptions(3, false);
					break;
				};
				case 4:
				case 6:
				case 9:
				case 12: {
					hideDayOptions(3, false);
					hideDayOptions(1, true);
					break;
				};
				case 2: {
					hideDayOptions(3, false);
					if (isLeapYear) {
						hideDayOptions(2, true);
					}else {
						hideDayOptions(3, true);
					}
					break;
				};
				default: break;
			}
	}
	
	function hideDayOptions(num, isNone){
		var dayOptions = document.querySelectorAll("#day-select > option");
		for (var i = 1; i <= num; i++) {
			if (isNone) {
				dayOptions[dayOptions.length - i].style.display = "none";
			}else {
				dayOptions[dayOptions.length - i].style.display = "block";
			}
		}
	}
	
	function setPageTimeDifference(){
		var pEle = document.getElementById("result-wrapper");
		var time= getTimeDifference();
		
		var str = "现在距离" + time.selectedDateTime.getFullYear() + "年"
		        + time.selectedDateTime.getMonth() + "月" + time.selectedDateTime.getDate() + "日 星期"
				+ transWeek(time.selectedDateTime.getDay()) + " " + time.selectedDateTime.getHours() + ":"
				+ time.selectedDateTime.getMinutes() + ":" + time.selectedDateTime.getSeconds() + (time.timeDifference.flag?" 已过去":" 还有")
				+ time.timeDifference.day + "天" + time.timeDifference.hour + "小时"
				+ time.timeDifference.second + "秒";
		
		pEle.innerHTML = str;
		setTimeout(setPageTimeDifference, 500);
	}
	
	function getTimeDifference(){
		
		// 获得当前时间
		var nowDateTime = new Date();
		
		//获得页面选择的时间(已转换为Date对象)
		var selectedDateTime = getSelectedTime();
		
		// 获得时间差,是个对象
		var timeDifference = getDifference(selectedDateTime, nowDateTime);
		
		return {timeDifference, selectedDateTime};
	}
	
	// 计算时间差
	function getDifference(date1, date2){
		
		// 相差的毫秒数
		var secondsDifference = Math.abs(date1.getTime() - date2.getTime());
		
		// 计算相差天数
		var dayDifference = Math.floor(secondsDifference / (24 * 60 * 60 * 1000));
		
		// 计算相差小时数
		var lastHourSeconds = secondsDifference % (24 * 60 * 60 * 1000); // 减去天数后剩余毫秒数
		var hourDifference = Math.floor(lastHourSeconds / (60 * 60 * 1000));
		
		// 计算相差分钟数
		var lastMinuteSeconds = lastHourSeconds % (60 * 60 * 1000); // 减去小时数后剩余毫秒数
		var minuteDifference = Math.floor(lastMinuteSeconds / (60 * 1000));
		
		// 计算相差秒数
		var lastSeconds = lastMinuteSeconds % (60 * 1000); //减去分钟数后剩余毫秒数
		var secondDifference = Math.floor(lastSeconds / 1000);
		
		var timeDifference = {
			day: dayDifference,
			hour: hourDifference,
			minute: minuteDifference,
			second: secondDifference,
			flag: (date1.getTime() - date2.getTime()) < 0
		}
		
		return timeDifference;
	}
	
	function transDate(time){
		var date = new Date();
		
		date.setFullYear(time.year,time.month - 1,time.day);
		
		date.setHours(time.hour);
		
		date.setMinutes(time.minute);
		
		date.setSeconds(time.second);
		
		return date;
	}
	
	// 将一周内的天数转换为星期
	function transWeek(day){
		// console.log(day);
		var week = [
		        "日",
		        "一",
				"二",
				"三",
				"四",
				"五",
				"六"
		    ]
		return week[day];
	}
	
	function getSelectedTime(){
		
		var selectedTime = {
			year: document.getElementById("year-select").value,
			month: document.getElementById("month-select").value,
			day: document.getElementById("day-select").value,
			hour: document.getElementById("hour-select").value,
			minute: document.getElementById("minite-select").value,
			second: document.getElementById("second-select").value
		};
		
		selectedDateTime = transDate(selectedTime);
		return selectedDateTime;
	}
	
	// 判断平闰年
	function judgeYearType(year){
		if ((year % 4 === 0 && year % 100 !== 0) || year % 400 === 0) {
			return true;
		}
		return false;
	}
	</script>
</body>
</html>